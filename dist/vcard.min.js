!function(e){function n(e){for(var n,t,o,u,f,i={},c=e.split(/\r\n|\r|\n/),p=c.length,l=0;p>l;l++)if(""!=c[l]&&c[l].toUpperCase()!=r&&c[l].toUpperCase()!=a){var s=c[l],h=function(e){return p>e+1&&(" "==c[e+1][0]||"	"==c[e+1][0])};if(h(l))for(;h(l);)s+=c[l+1].trim(),l++;if(n=s.split(":"),t=n.shift(),o=n.join(":"),f=!1,u={},t.match(/;/)){t=t.replace(/\\;/g,"ΩΩΩ").replace(/\\,/,",");var v=t.split(";").map(function(e){return e.replace(/ΩΩΩ/g,";")});t=v.shift(),v.forEach(function(e){var n=e.split("=");n[0]=n[0].toLowerCase(),0!==n[0].length&&(u[n[0]]?u[n[0]].push(n[1]):u[n[0]]=[n[1]])})}if(o=o.replace(/\\n/g,"\n").replace(/\\,/g,","),o.match(/;/)&&(o=o.replace(/\\;/g,"ΩΩΩ"),o.match(/;/)?(o=o.split(";"),o=o.map(function(e){return e.replace(/ΩΩΩ/g,";")})):o=o.replace(/ΩΩΩ/g,";")),t.match(/\./)){var g=t.split(".");t=g[1],f=g[0]}var d={value:o};Object.keys(u).length&&(d.meta=u),f&&(d.namespace=f),0!==t.indexOf("X-")&&(t=t.toLowerCase()),"undefined"==typeof i[t]?i[t]=[d]:i[t].push(d)}return i}function t(e,n){var t=[r],u="";n&&!e.version&&(e.version=[{value:"3.0"}]),n&&!e.uid&&(e.uid=[{value:o()}]);var f=function(e){return"undefined"==typeof e?"":e.replace(/\n/g,"\\n").replace(/;/g,"\\;").replace(/,/g,"\\,")};return Object.keys(e).forEach(function(n){e[n]&&"function"==typeof e[n].forEach&&e[n].forEach(function(e){if("undefined"!=typeof e.value&&""!=e.value){if(e.value instanceof Array){for(var r=!0,a=0;a<e.value.length;a++)if("undefined"!=typeof e.value[a]&&""!=e.value[a]){r=!1;break}if(r)return}if(u="",e.namespace&&(u+=e.namespace+"."),u+=0===n.indexOf("X-")?n:n.toUpperCase(),"object"==typeof e.meta&&Object.keys(e.meta).forEach(function(n){"function"==typeof e.meta[n].forEach&&e.meta[n].forEach(function(e){n.length>0&&(u+=";"+f(n.toUpperCase())+"="+f(e))})}),u+=":","string"==typeof e.value?u+=f(e.value):(e.value=e.value.map(function(e){return f(e)}),u+=e.value.join(";")),u.length>75){var o=u.substr(0,75),i=u.substr(75),c=i.match(/.{1,74}/g);t.push(o),c.forEach(function(e){t.push(" "+e)})}else t.push(u)}})}),t.push(a),t.join("\r\n")}var r="BEGIN:VCARD",a="END:VCARD",o=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}();e.vCard={parse:n,generate:t}}("undefined"!=typeof window?window:module.exports);